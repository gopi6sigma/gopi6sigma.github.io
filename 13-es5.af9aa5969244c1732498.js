function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{Cimy:function(e,t,i){"use strict";i.r(t),i.d(t,"PaperUploadModule",(function(){return b}));var n=i("ofXK"),r=i("tyNb"),a=i("PCNd"),c=i("3Pt+"),o=i("QKVY"),s=i("XNiG"),l=i("fXoL"),d=i("yTNM"),g=i("Bfb3");function h(e,t){if(1&e&&(l.Lc(0,"p"),l.Ad(1),l.Kc()),2&e){var i=l.Zc();l.rc(1),l.Cd("Status Here: ",i.status,"")}}function u(e,t){if(1&e){var i=l.Mc();l.Lc(0,"div",9),l.Lc(1,"webcam",10),l.Xc("imageCapture",(function(e){return l.qd(i),l.Zc().snapshot(e)}))("initError",(function(e){return l.qd(i),l.Zc().handleWebcamInitError(e)})),l.Kc(),l.Lc(2,"div"),l.Lc(3,"button",11),l.Xc("click",(function(){return l.qd(i),l.Zc().captureImage()})),l.Ad(4),l.Kc(),l.Kc(),l.Kc()}if(2&e){var n=l.Zc();l.rc(1),l.gd("trigger",n.$trigger)("allowCameraSwitch",!0)("height",480)("width",640)("imageQuality",1)("videoOptions",n.videoOptions),l.rc(3),l.Bd(n.captureBtnLable)}}function m(e,t){if(1&e&&l.Gc(0,"img",12),2&e){var i=l.Zc();l.gd("src",i.webcamPreviewImage,l.td)}}function p(e,t){if(1&e){var i=l.Mc();l.Lc(0,"div"),l.Lc(1,"button",13),l.Xc("click",(function(){return l.qd(i),l.Zc().sendDetails()})),l.Ad(2,"Upload"),l.Kc(),l.Kc()}}var f,w,v=[{path:"",component:(f=function(){function e(t,i,n,r,a){_classCallCheck(this,e),this.fb=t,this.cd=i,this.apiService=n,this.router=r,this.imageUploadService=a,this.labelsList=[],this.serverResponce="",this.isResponceSuccess=!1,this.showLeftDiv=!0,this.paperImage="",this.maxDate=(new Date).toLocaleDateString(),this.formSubmitted=!1,this.showWebcam=!0,this.allowCameraSwitch=!0,this.multipleWebcamsAvailable=!1,this.errors=[],this.previewImage="https://h5p.org/sites/default/files/styles/medium-logo/public/logos/drag-and-drop-icon.png?itok=0dFV3ej6",this.url="https://h5p.org/sites/default/files/styles/medium-logo/public/logos/drag-and-drop-icon.png?itok=0dFV3ej6",this.stream=null,this.status=null,this.trigger=new s.a,this.webcamPreviewImage="",this.webcamImg=null,this.captureBtnLable="",this.facingMode="environment"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;o.c.getAvailableVideoInputs().then((function(t){e.multipleWebcamsAvailable=t&&t.length>1}))}},{key:"hideAlert",value:function(){this.showLeftDiv=!0,this.webcamPreviewImage=""}},{key:"sendDetails",value:function(){var e=this;try{if(this.paperImage){var t=new FormData;t.append("answerSheet",this.answerSheet),this.apiService.showLoader.next(!0),this.apiService.addPaperImage(t).subscribe((function(t){if(t&&"string"==typeof t){var i=JSON.parse(t);i&&i.message&&(e.apiService.genericMessage(i.message,"success"),e.apiService.showLoader.next(!1),e.showLeftDiv=!0,e.webcamPreviewImage="")}}),(function(t){if(e.apiService.showLoader.next(!1),401!==t.status){if(t.error){console.log(t.error);var i="string"==typeof t.error?JSON.parse(t.error):{};e.apiService.genericMessage(i.error||"something went wrong","error")}}else e.router.navigate(["/login"])}))}}catch(i){console.warn(i)}}},{key:"videoOptions",get:function(){var e={};return this.facingMode&&""!==this.facingMode&&(e.facingMode={ideal:this.facingMode}),e}},{key:"$trigger",get:function(){return this.trigger.asObservable()}},{key:"snapshot",value:function(e){console.log("snapshot",e),this.webcamPreviewImage=e.imageAsDataUrl,this.paperImage=e.imageAsDataUrl,this.captureBtnLable="Retake Image";for(var t=e.imageAsDataUrl.split(","),i=(t[0].match(/:(.*?);/),atob(t[1])),n=i.length,r=new Uint8Array(n);n--;)r[n]=i.charCodeAt(n);var a=new File([r],"AnswerSheet",{type:"JPEG"});console.log(a),this.answerSheet=a}},{key:"checkPermissions",value:function(){var e=this;console.log("checkPermissions"),navigator.mediaDevices.getUserMedia({video:{width:500,height:500}}).then((function(t){console.log("Camera allowed: ",t),e.stream=t,e.status="Allowed",e.captureBtnLable="Capture Image"})).catch((function(t){console.log(t),e.status="Permission denied"===(null==t?void 0:t.message)?"Permission Denied please allow camera access":"Camera not found. Please retry..."}))}},{key:"captureImage",value:function(){this.trigger.next(),this.showLeftDiv=!1}},{key:"handleWebcamInitError",value:function(e){e.mediaStreamError&&"NotAllowedError"===e.mediaStreamError.name&&console.warn("Camera access was not allowed by user!"),this.errors.push(e)}}]),e}(),f.\u0275fac=function(e){return new(e||f)(l.Fc(c.d),l.Fc(l.j),l.Fc(d.a),l.Fc(r.c),l.Fc(g.a))},f.\u0275cmp=l.zc({type:f,selectors:[["app-new-image-upload"]],inputs:{labelsList:"labelsList"},decls:12,vars:5,consts:[[1,"card","shadow"],[1,"card-body"],[1,"card-text"],[3,"formGroup"],[1,"col-12","col-sm-6","col-md-4","web-perms-button-div"],["type","button",1,"my-btn","web-perms-btn",3,"click"],[4,"ngIf"],["class","row",4,"ngIf"],["height","480","width","640",3,"src",4,"ngIf"],[1,"row"],[3,"trigger","allowCameraSwitch","height","width","imageQuality","videoOptions","imageCapture","initError"],["type","button",1,"my-btn","my-btn-primary",3,"click"],["height","480","width","640",3,"src"],["type","button",1,"mx-auto","my-btn","my-btn-primary",3,"click"]],template:function(e,t){1&e&&(l.Lc(0,"div",0),l.Lc(1,"div",1),l.Lc(2,"div",2),l.Lc(3,"form",3),l.Lc(4,"div",4),l.Lc(5,"button",5),l.Xc("click",(function(){return t.checkPermissions()})),l.Ad(6,"Webcam Permissions"),l.Kc(),l.yd(7,h,2,1,"p",6),l.Kc(),l.yd(8,u,5,7,"div",7),l.Lc(9,"div"),l.yd(10,m,1,1,"img",8),l.yd(11,p,3,0,"div",6),l.Kc(),l.Kc(),l.Kc(),l.Kc(),l.Kc()),2&e&&(l.rc(3),l.gd("formGroup",t.galleryUpload),l.rc(4),l.gd("ngIf",t.status),l.rc(1),l.gd("ngIf",t.stream),l.rc(2),l.gd("ngIf",t.webcamPreviewImage),l.rc(1),l.gd("ngIf",t.webcamPreviewImage))},directives:[c.v,c.m,c.f,n.l,o.a],styles:[".title[_ngcontent-%COMP%]{font-weight:500;text-align:center}.dnd-container[_ngcontent-%COMP%]{width:100%;margin:auto;height:10rem;border:1px dashed #745cf2}.dnd-container[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{width:20%;height:20%}.label[_ngcontent-%COMP%]{display:inline-block;min-width:100px}#parent[_ngcontent-%COMP%]{display:flex}#left[_ngcontent-%COMP%], #right[_ngcontent-%COMP%]{border:1px solid #d3d3d3;background-color:#fff;width:50%;position:relative}.webcam-image[_ngcontent-%COMP%]{max-width:100%;height:auto;display:block;margin:0 auto}.preview-image[_ngcontent-%COMP%]{width:100%;height:15rem}.web-perms-button-div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.web-perms-btn[_ngcontent-%COMP%]{color:#000}"]}),f)}],b=((w=function e(){_classCallCheck(this,e)}).\u0275mod=l.Dc({type:w}),w.\u0275inj=l.Cc({factory:function(e){return new(e||w)},imports:[[n.b,r.g.forChild(v),c.s,c.g,a.a,o.b]]}),w)}}]);